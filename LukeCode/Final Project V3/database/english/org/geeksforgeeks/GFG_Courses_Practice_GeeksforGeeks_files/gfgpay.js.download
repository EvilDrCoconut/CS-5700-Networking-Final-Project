function rtrim(str,chr){var rgxtrim=!chr?new RegExp("\\s+$"):new RegExp(chr+"+$");return str.replace(rgxtrim,"")}$("document").ready(function(){$("body").on("click",".gfgpay",function(event){event.preventDefault();var thisBtn=$(this);$(this).prop("disabled","true");var formData=new FormData;formData.append("pid",$(this).attr("pid"));formData.append("ptype",$(this).attr("ptype"));formData.append("gtoken",$(this).attr("gtoken"));formData.append("utoken",$(this).attr("utoken"));formData.append("requestType","fetchDetails");$.ajax({type:"POST",url:"/ajax/gfgPayment.php",processData:false,contentType:false,data:formData,success:function(response){if(response["status"]=="SUCCESS"){$("#gfg-payment-confirm").remove();$(response["message"]).insertBefore("footer");$("#gfg-payment-confirm").modal("show")}else if(response["status"]=="error"){displayError("","",response["message"])}},error:function(jqXHR,exception){displayError(jqXHR,exception,"")},complete:function(response){thisBtn.prop("disabled","")}})});$("body").on("click",".gfgpay-close",function(event){$("#gfg-payment-confirm").modal("hide");setTimeout(function(){$("#gfg-payment-confirm").remove()},200)});$("body").on("click",".gfg-paynow",function(event){event.preventDefault();$(this).prop("disabled","true");$(".gfg-paynow").html("Processing <i class='fa fa-spin fa-spinner'></i>");var formData=new FormData;formData.append("requestType","createOrder");formData.append("futoken",$("#futoken").val());formData.append("trantoken",$("#trantoken").val());if(typeof couponApplied!=="undefined"&&couponApplied!=false){formData.append("couponCode",appliedCC)}$.ajax({type:"POST",url:"/ajax/gfgPayment.php",processData:false,contentType:false,data:formData,success:function(response){if(response["status"]=="SUCCESS"){if(response["message"].hasOwnProperty("refresh")){$(".gfg-paynow").css("display","none");$("#gfg-payment-confirm").find(".modal-body").html('<div style="text-align:center"><i class="fas fa-check-circle" style="font-size:100px; color:#098043"></i><br><h3 style="color:#098043;">Enrollment Confirmed.</h3> <br>Reloading Page in 3 seconds...</div>');setTimeout(function(){location.reload()},5e3)}else{$("#gfg-payment-confirm").find(".modal-footer").html(response["message"]);$("#rzp-pay-button").trigger("click");$("#gfg-payment-confirm").modal("hide");setTimeout(function(){$("#gfg-payment-confirm").remove()},200)}}else if(response["status"]=="error"){$("#gfg-payment-confirm").modal("hide");setTimeout(function(){$("#gfg-payment-confirm").remove()},200);displayError("","",response["message"])}},error:function(jqXHR,exception){$("#gfg-payment-confirm").modal("hide");setTimeout(function(){$("#gfg-payment-confirm").remove()},200);displayError(jqXHR,exception,"")},complete:function(response){}})})});function verifyPayment(rzpResponse,utoken){$('<div id="gfgpay-loading-wrap" class="text-center" style="position:fixed; height:100%;  width:100%;  top:0; left:0;background-color: #6cd27f24;padding: 10% 30% 30% 25%;"> <h3> <i class="fa fa-spin fa-spinner" style="font-size: 75px;"></i><br>Processing... <br> Please do not Refresh/Close this tab.</h3></div>').insertBefore("footer");var formData=new FormData;formData.append("requestType","verifyPayment");formData.append("utoken",utoken);formData.append("razorpay_payment_id",rzpResponse.razorpay_payment_id);formData.append("razorpay_order_id",rzpResponse.razorpay_order_id);formData.append("razorpay_signature",rzpResponse.razorpay_signature);$.ajax({type:"POST",url:"/ajax/gfgPayment.php",processData:false,contentType:false,data:formData,success:function(response){$("#gfgpay-loading-wrap").remove();if(response["status"]=="SUCCESS"){gtag("event","conversion",{send_to:"AW-796001856/DLCZCKWT4qkBEMCMyPsC"});$(response["message"]).insertBefore("footer");$("#gfg-tran-completed").modal("show");if(response["type"]==102){var base_url=window.location.origin;setTimeout(function(){location.href=base_url+"/user/mocks"},3e3)}else{url=rtrim(window.location.origin+window.location.pathname,"/");url+="?payment=true";setTimeout(function(){window.location.href=url},3e3)}}else if(response["status"]=="error"){displayError("","",response["message"])}},error:function(jqXHR,exception){$("#gfgpay-loading-wrap").remove();displayError(jqXHR,exception,"")},complete:function(response){}})}function displayError(jqXHR,exception,msg){if(msg!=""){}else if(jqXHR.status===0){msg="Can't connect.\n Check your internet connection."}else if(jqXHR.status==404){msg="Requested page not found. [404]"}else if(jqXHR.status==500){msg="Internal Server Error [500]."}else if(exception==="parsererror"){msg="Requested JSON parse failed."}else if(exception==="timeout"){msg="Time out error."}else if(exception==="abort"){msg="Ajax request aborted."}else{msg="Uncaught Error.\n"+jqXHR.responseText}$("#gfg-snackbar").text(msg);$("#gfg-snackbar").addClass("show");setTimeout(function(){$("#gfg-snackbar").removeClass("show")},6e3)}$("body").on("click",".coupon-check",function(event){$(".coupon-check").hide();$(".apply-coupon-div").show()});var couponApplied=false;var appliedCC=false;$("body").on("click",".apply-coupon, .remove-coupon",function(event){event.preventDefault();var total_amount=$("#total-amount").text();var $this=$(this);if($(this).hasClass("apply-coupon")){$(this).prop("disabled","true");$(this).html("Applying <i class='fa fa-spin fa-spinner'></i>");appliedCC=$("#coupon-code").val();var formData=new FormData;formData.append("requestType","applyCoupon");formData.append("ptype",$("#ptype").val());formData.append("futoken",$("#futoken").val());formData.append("trantoken",$("#trantoken").val());formData.append("couponCode",$("#coupon-code").val());$.ajax({type:"POST",url:"/ajax/gfgPayment.php",processData:false,contentType:false,data:formData,success:function(response){if(response["status"]=="SUCCESS"){$(".coupon-disc").show();$(".coupon-div").hide();$("#total-amount").text(response["message"]["totalAmount"]);$("#discount-amount").text(response["message"]["discount"]);var payableAmount=parseInt(response["message"]["totalAmount"])-Math.abs(parseInt(response["message"]["discount"]));if(payableAmount>0){$("#final-amount").text(payableAmount)}else{$("#final-amount").text(0);$("#gfg-payment-confirm").find(".modal-body").append("<div class='errorMessage' style='color:red;margin: 5px 0px 0px 10px;'><small>Congratulations !! You have got this product for free</small></div>");$(".gfg-paynow").text("Proceed to Confirm")}couponApplied=true}else if(response["status"]=="error"){if($(".errorMessage").length){$(".errorMessage").remove()}$(".coupon-div").append("<div class='errorMessage' style='color:red;margin: 5px 0px 0px 10px;'><small>"+response["message"]+"</small></div>")}},error:function(jqXHR,exception){$("#gfg-payment-confirm").modal("hide");setTimeout(function(){$("#gfg-payment-confirm").remove()},200);displayError(jqXHR,exception,"")},complete:function(response){$this.prop("disabled","false");$this.html("Apply")}})}else if($(this).hasClass("remove-coupon")){couponApplied=false;$("#total-amount").text(total_amount);$(".coupon-disc").hide();$(".errorMessage").remove();$(".coupon-div").show();$(".apply-coupon-div").hide();$(".coupon-check").show()}});